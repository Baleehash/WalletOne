<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transfer - WalletOne</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#FF6B6B',
                        accent: '#10B981',
                        warning: '#F59E0B',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .fade-in-up {
            animation: fadeInUp 0.5s ease-out;
        }
        .slide-down {
            animation: slideDown 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <div class="bg-primary text-white p-6 pb-8">
        <div class="flex items-center mb-6">
            <a href="index.html" class="mr-4">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </a>
            <h1 class="text-xl font-bold">Transfer Saldo</h1>
        </div>
    </div>

    <!-- Main Content -->
    <div class="px-4 -mt-4 pb-24">
        <!-- Select Source Wallet -->
        <div class="bg-white rounded-2xl shadow-md p-5 mb-4 fade-in-up">
            <label class="block text-sm font-semibold text-gray-700 mb-3">Dari E-Wallet</label>
            <div class="space-y-3">
                <div class="wallet-option border-2 border-primary rounded-xl p-4 cursor-pointer bg-primary bg-opacity-5" onclick="selectSourceWallet('DANA')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center">
                                <span class="text-white font-bold text-lg">D</span>
                            </div>
                            <div>
                                <p class="font-bold text-gray-800">DANA</p>
                                <p class="text-sm text-gray-500">Rp 2.450.000</p>
                            </div>
                        </div>
                        <div class="w-5 h-5 rounded-full border-2 border-primary bg-primary flex items-center justify-center">
                            <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="wallet-option border-2 border-gray-200 rounded-xl p-4 cursor-pointer hover:border-gray-300" onclick="selectSourceWallet('GoPay')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center">
                                <span class="text-white font-bold text-lg">G</span>
                            </div>
                            <div>
                                <p class="font-bold text-gray-800">GoPay</p>
                                <p class="text-sm text-gray-500">Rp 1.850.000</p>
                            </div>
                        </div>
                        <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                    </div>
                </div>
                <div class="wallet-option border-2 border-gray-200 rounded-xl p-4 cursor-pointer hover:border-gray-300" onclick="selectSourceWallet('ShopeePay')">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-orange-500 rounded-xl flex items-center justify-center">
                                <span class="text-white font-bold text-lg">S</span>
                            </div>
                            <div>
                                <p class="font-bold text-gray-800">ShopeePay</p>
                                <p class="text-sm text-gray-500">Rp 980.000</p>
                            </div>
                        </div>
                        <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Transfer Details -->
        <div class="bg-white rounded-2xl shadow-md p-5 mb-4 fade-in-up" style="animation-delay: 0.1s">
            <label class="block text-sm font-semibold text-gray-700 mb-3">Nomor HP / Email Tujuan</label>
            <input
                type="text"
                id="recipientInput"
                placeholder="Masukkan nomor HP atau email"
                class="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-primary focus:outline-none mb-4"
            >

            <label class="block text-sm font-semibold text-gray-700 mb-3">Nominal Transfer</label>
            <div class="relative mb-4">
                <span class="absolute left-4 top-4 text-gray-600 font-semibold text-lg">Rp</span>
                <input
                    type="number"
                    id="amountInput"
                    placeholder="0"
                    class="w-full p-4 pl-12 border-2 border-gray-200 rounded-xl focus:border-primary focus:outline-none text-lg font-bold"
                >
            </div>

            <!-- Quick Amount Buttons -->
            <div class="grid grid-cols-3 gap-2 mb-4">
                <button onclick="setAmount(50000)" class="py-2 px-3 bg-gray-100 text-gray-700 rounded-lg text-sm font-semibold hover:bg-gray-200">50K</button>
                <button onclick="setAmount(100000)" class="py-2 px-3 bg-gray-100 text-gray-700 rounded-lg text-sm font-semibold hover:bg-gray-200">100K</button>
                <button onclick="setAmount(200000)" class="py-2 px-3 bg-gray-100 text-gray-700 rounded-lg text-sm font-semibold hover:bg-gray-200">200K</button>
            </div>

            <label class="block text-sm font-semibold text-gray-700 mb-3">Catatan (Opsional)</label>
            <textarea
                id="noteInput"
                placeholder="Tambahkan catatan transfer"
                rows="3"
                class="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-primary focus:outline-none resize-none"
            ></textarea>
        </div>

        <!-- Recent Recipients -->
        <div class="bg-white rounded-2xl shadow-md p-5 fade-in-up" style="animation-delay: 0.2s">
            <h3 class="text-sm font-semibold text-gray-700 mb-3">Penerima Terakhir</h3>
            <div class="space-y-3">
                <div class="flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-xl cursor-pointer" onclick="selectRecipient('0812-3456-7890', 'Budi Santoso')">
                    <div class="w-12 h-12 bg-primary bg-opacity-10 rounded-full flex items-center justify-center">
                        <span class="text-primary font-bold text-lg">B</span>
                    </div>
                    <div class="flex-1">
                        <p class="font-semibold text-gray-800">Budi Santoso</p>
                        <p class="text-sm text-gray-500">0812-3456-7890</p>
                    </div>
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </div>
                <div class="flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-xl cursor-pointer" onclick="selectRecipient('siti.rahma@email.com', 'Siti Rahmawati')">
                    <div class="w-12 h-12 bg-accent bg-opacity-10 rounded-full flex items-center justify-center">
                        <span class="text-accent font-bold text-lg">S</span>
                    </div>
                    <div class="flex-1">
                        <p class="font-semibold text-gray-800">Siti Rahmawati</p>
                        <p class="text-sm text-gray-500">siti.rahma@email.com</p>
                    </div>
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </div>
                <div class="flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-xl cursor-pointer" onclick="selectRecipient('0856-7890-1234', 'Ahmad Fauzi')">
                    <div class="w-12 h-12 bg-secondary bg-opacity-10 rounded-full flex items-center justify-center">
                        <span class="text-secondary font-bold text-lg">A</span>
                    </div>
                    <div class="flex-1">
                        <p class="font-semibold text-gray-800">Ahmad Fauzi</p>
                        <p class="text-sm text-gray-500">0856-7890-1234</p>
                    </div>
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </div>
            </div>
        </div>
    </div>

    <!-- Fixed Bottom Button -->
    <div class="fixed bottom-20 left-0 right-0 p-4 bg-white border-t border-gray-200">
        <button onclick="reviewTransfer()" class="w-full bg-primary text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-opacity-90 transition">
            Lanjutkan
        </button>
    </div>

    <!-- Floating Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-6 py-3" style="backdrop-filter: blur(10px); background-color: rgba(255, 255, 255, 0.95);">
        <div class="flex justify-around items-center">
            <a href="index.html" class="flex flex-col items-center space-y-1 text-gray-400 hover:text-primary transition">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                </svg>
                <span class="text-xs font-medium">Beranda</span>
            </a>
            <a href="transfer.html" class="flex flex-col items-center space-y-1 text-primary transition relative">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M8 5a1 1 0 100 2h5.586l-1.293 1.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L13.586 5H8zM12 15a1 1 0 100-2H6.414l1.293-1.293a1 1 0 10-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L6.414 15H12z"/>
                </svg>
                <span class="text-xs font-bold">Transfer</span>
                <div class="absolute -top-1 w-1 h-1 bg-primary rounded-full"></div>
            </a>
            <a href="history.html" class="flex flex-col items-center space-y-1 text-gray-400 hover:text-primary transition">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span class="text-xs font-medium">Riwayat</span>
            </a>
            <a href="budget.html" class="flex flex-col items-center space-y-1 text-gray-400 hover:text-primary transition">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                <span class="text-xs font-medium">Analisis</span>
            </a>
            <a href="profile.html" class="flex flex-col items-center space-y-1 text-gray-400 hover:text-primary transition">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                </svg>
                <span class="text-xs font-medium">Profil</span>
            </a>
        </div>
    </nav>

    <script>
        let selectedSource = 'DANA';
        let selectedRecipient = null;

        function selectSourceWallet(wallet) {
            selectedSource = wallet;
            // Update UI to show selected wallet
            document.querySelectorAll('.wallet-option').forEach(option => {
                option.classList.remove('border-primary', 'bg-primary', 'bg-opacity-5');
                option.classList.add('border-gray-200');
                const checkmark = option.querySelector('.w-5.h-5');
                checkmark.classList.remove('border-primary', 'bg-primary');
                checkmark.classList.add('border-gray-300');
                checkmark.innerHTML = '';
            });

            event.currentTarget.classList.remove('border-gray-200');
            event.currentTarget.classList.add('border-primary', 'bg-primary', 'bg-opacity-5');
            const checkmark = event.currentTarget.querySelector('.w-5.h-5');
            checkmark.classList.remove('border-gray-300');
            checkmark.classList.add('border-primary', 'bg-primary');
            checkmark.innerHTML = '<svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>';
        }

        function selectRecipient(contact, name) {
            document.getElementById('recipientInput').value = contact;
            selectedRecipient = { contact, name };
        }

        function setAmount(amount) {
            document.getElementById('amountInput').value = amount;
        }

        function reviewTransfer() {
            const recipient = document.getElementById('recipientInput').value;
            const amount = document.getElementById('amountInput').value;
            const note = document.getElementById('noteInput').value;

            if (!recipient) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Data Tidak Lengkap',
                    text: 'Mohon masukkan nomor HP atau email penerima',
                    confirmButtonColor: '#4F46E5',
                });
                return;
            }

            if (!amount || amount <= 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Data Tidak Lengkap',
                    text: 'Mohon masukkan nominal transfer',
                    confirmButtonColor: '#4F46E5',
                });
                return;
            }

            const formattedAmount = parseInt(amount).toLocaleString('id-ID');

            Swal.fire({
                title: 'Konfirmasi Transfer',
                html: `
                    <div style="text-align: left; padding: 10px;">
                        <div style="background: #F9FAFB; padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                            <p style="font-size: 13px; color: #6B7280; margin-bottom: 5px;">Dari</p>
                            <p style="font-size: 16px; font-weight: bold; color: #111827;">${selectedSource}</p>
                        </div>
                        <div style="background: #F9FAFB; padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                            <p style="font-size: 13px; color: #6B7280; margin-bottom: 5px;">Kepada</p>
                            <p style="font-size: 16px; font-weight: bold; color: #111827;">${selectedRecipient ? selectedRecipient.name : recipient}</p>
                            <p style="font-size: 14px; color: #6B7280;">${recipient}</p>
                        </div>
                        <div style="background: #EEF2FF; padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                            <p style="font-size: 13px; color: #4F46E5; margin-bottom: 5px;">Nominal</p>
                            <p style="font-size: 22px; font-weight: bold; color: #4F46E5;">Rp ${formattedAmount}</p>
                        </div>
                        ${note ? `
                        <div style="background: #F9FAFB; padding: 15px; border-radius: 12px;">
                            <p style="font-size: 13px; color: #6B7280; margin-bottom: 5px;">Catatan</p>
                            <p style="font-size: 14px; color: #111827;">${note}</p>
                        </div>
                        ` : ''}
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: 'Transfer Sekarang',
                cancelButtonText: 'Batal',
                confirmButtonColor: '#4F46E5',
                cancelButtonColor: '#6B7280',
            }).then((result) => {
                if (result.isConfirmed) {
                    showBiometricAuth(recipient, amount, note);
                }
            });
        }

        function showBiometricAuth(recipient, amount, note) {
            Swal.fire({
                title: 'Verifikasi Sidik Jari',
                html: `
                    <div style="text-align: center; padding: 20px;">
                        <div style="width: 100px; height: 100px; background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%); border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; animation: pulse 2s ease-in-out infinite;">
                            <svg style="width: 60px; height: 60px; color: white;" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M6.625 2.655A9 9 0 0119 11a1 1 0 11-2 0 7 7 0 00-9.625-6.492 1 1 0 11-.75-1.853zM4.662 4.959A1 1 0 014.75 6.37 6.97 6.97 0 003 11a1 1 0 11-2 0 8.97 8.97 0 012.25-5.953 1 1 0 011.412-.088z" clip-rule="evenodd"/>
                                <path fill-rule="evenodd" d="M5 11a5 5 0 1110 0 1 1 0 11-2 0 3 3 0 10-6 0c0 1.677-.345 3.276-.968 4.729a1 1 0 11-1.838-.789A9.964 9.964 0 005 11z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <p style="margin-bottom: 10px; font-weight: bold;">Letakkan jari Anda pada sensor</p>
                        <p style="font-size: 14px; color: #666;">Autentikasi biometrik diperlukan untuk melanjutkan</p>
                    </div>
                `,
                showCancelButton: true,
                showConfirmButton: false,
                cancelButtonText: 'Batal',
                didOpen: () => {
                    setTimeout(() => {
                        const isSuccess = Math.random() > 0.3; // 70% success rate
                        if (isSuccess) {
                            Swal.close();
                            handleTransferSuccess(recipient, amount, note);
                        } else {
                            Swal.close();
                            handleAuthFail();
                        }
                    }, 2000);
                }
            });
        }

        function handleTransferSuccess(recipient, amount, note) {
            const formattedAmount = parseInt(amount).toLocaleString('id-ID');
            Swal.fire({
                icon: 'success',
                title: 'Transfer Berhasil!',
                html: `
                    <div style="text-align: center; padding: 10px;">
                        <p style="font-size: 16px; color: #6B7280; margin-bottom: 10px;">Transfer sebesar</p>
                        <p style="font-size: 28px; font-weight: bold; color: #10B981; margin-bottom: 15px;">Rp ${formattedAmount}</p>
                        <p style="font-size: 14px; color: #6B7280;">kepada <strong>${selectedRecipient ? selectedRecipient.name : recipient}</strong> berhasil diproses</p>
                    </div>
                `,
                confirmButtonText: 'Kembali ke Beranda',
                confirmButtonColor: '#4F46E5',
            }).then(() => {
                window.location.href = 'index.html';
            });
        }

        function handleAuthFail() {
            Swal.fire({
                icon: 'error',
                title: 'Autentikasi Gagal',
                text: 'Sidik jari tidak dikenali. Silakan coba lagi.',
                showCancelButton: true,
                confirmButtonText: 'Coba Lagi',
                cancelButtonText: 'Batal',
                confirmButtonColor: '#4F46E5',
                cancelButtonColor: '#6B7280',
            }).then((result) => {
                if (result.isConfirmed) {
                    const recipient = document.getElementById('recipientInput').value;
                    const amount = document.getElementById('amountInput').value;
                    const note = document.getElementById('noteInput').value;
                    showBiometricAuth(recipient, amount, note);
                }
            });
        }

        // Simple frontend-only auth check
        if (!localStorage.getItem('walletone_logged_in')) {
            window.location.href = 'login.html';
        }

        // Animation on page load
        document.addEventListener('DOMContentLoaded', function() {
            const elements = document.querySelectorAll('.fade-in-up');
            elements.forEach((el, index) => {
                setTimeout(() => {
                    el.style.opacity = '1';
                }, index * 100);
            });
        });
    </script>
</body>
</html>
